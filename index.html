<!--<script language="javascript">
document.write(unescape('%3C%21%44%4F%43%54%59%50%45%20%68%74%6D%6C%3E%0A%3C%68%74%6D%6C%20%6C%61%6E%67%3D%22%65%6E%22%3E%0A%3C%68%65%61%64%3E%0A%20%20%3C%6D%65%74%61%20%63%68%61%72%73%65%74%3D%22%55%54%46%2D%38%22%3E%0A%20%20%3C%6D%65%74%61%20%6E%61%6D%65%3D%22%76%69%65%77%70%6F%72%74%22%20%63%6F%6E%74%65%6E%74%3D%22%77%69%64%74%68%3D%64%65%76%69%63%65%2D%77%69%64%74%68%2C%20%69%6E%69%74%69%61%6C%2D%73%63%61%6C%65%3D%31%22%3E%0A%20%20%3C%74%69%74%6C%65%3E%41%75%74%6F%2D%50%61%67%65%62%6F%74%3C%2F%74%69%74%6C%65%3E%0A%20%20%3C%6D%65%74%61%20%6E%61%6D%65%3D%22%64%65%73%63%72%69%70%74%69%6F%6E%22%20%63%6F%6E%74%65%6E%74%3D%22%41%75%74%6F%20%50%61%67%65%42%6F%74%20%69%73%20%61%20%4D%65%73%73%65%6E%67%65%72%20%61%75%74%6F%6D%61%74%69%6F%6E%20%74%6F%6F%6C%20%66%6F%72%20%46%61%63%65%62%6F%6F%6B%20%70%61%67%65%73%2C%20%6D%61%6B%69%6E%67%20%69%74%20%65%61%73%79%20%74%6F%20%6D%61%6E%61%67%65%20%61%6E%64%20%61%75%74%6F%6D%61%74%65%20%79%6F%75%72%20%4D%65%73%73%65%6E%67%65%72%20%65%78%70%65%72%69%65%6E%63%65%2E%22%3E%0A%20%20%3C%6C%69%6E%6B%20%72%65%6C%3D%22%69%63%6F%6E%22%20%68%72%65%66%3D%22%68%74%74%70%73%3A%2F%2F%61%76%61%74%61%72%73%2E%67%69%74%68%75%62%75%73%65%72%63%6F%6E%74%65%6E%74%2E%63%6F%6D%2F%75%2F%31%34%33%36%38%36%35%30%37%3F%76%3D%34%22%2F%3E%0A%20%20%3C%6D%65%74%61%20%70%72%6F%70%65%72%74%79%3D%22%6F%67%3A%69%6D%61%67%65%22%20%63%6F%6E%74%65%6E%74%3D%22%68%74%74%70%73%3A%2F%2F%61%76%61%74%61%72%73%2E%67%69%74%68%75%62%75%73%65%72%63%6F%6E%74%65%6E%74%2E%63%6F%6D%2F%75%2F%31%34%33%36%38%36%35%30%37%3F%76%3D%34%22%3E%0A%20%20%3C%6C%69%6E%6B%20%68%72%65%66%3D%22%68%74%74%70%73%3A%2F%2F%66%6F%6E%74%73%2E%67%6F%6F%67%6C%65%61%70%69%73%2E%63%6F%6D%2F%63%73%73%32%3F%66%61%6D%69%6C%79%3D%4F%75%74%66%69%74%3A%77%67%68%74%40%34%30%30%3B%36%30%30%3B%37%30%30%26%64%69%73%70%6C%61%79%3D%73%77%61%70%22%20%72%65%6C%3D%22%73%74%79%6C%65%73%68%65%65%74%22%3E%0A%20%20%3C%6C%69%6E%6B%20%68%72%65%66%3D%22%68%74%74%70%73%3A%2F%2F%66%6F%6E%74%73%2E%67%6F%6F%67%6C%65%61%70%69%73%2E%63%6F%6D%2F%63%73%73%32%3F%66%61%6D%69%6C%79%3D%53%70%61%63%65%2B%47%72%6F%74%65%73%6B%3A%77%67%68%74%40%34%30%30%3B%36%30%30%3B%37%30%30%26%64%69%73%70%6C%61%79%3D%73%77%61%70%22%20%72%65%6C%3D%22%73%74%79%6C%65%73%68%65%65%74%22%3E%0A%20%20%20%20%3C%73%74%79%6C%65%3E%0A%20%20%20%20%20%20%20%20%62%6F%64%79%2C%20%68%74%6D%6C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%6D%61%72%67%69%6E%3A%20%30%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%70%61%64%64%69%6E%67%3A%20%30%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%68%65%69%67%68%74%3A%20%31%30%30%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%6F%76%65%72%66%6C%6F%77%3A%20%68%69%64%64%65%6E%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2E%77%65%62%76%69%65%77%2D%63%6F%6E%74%61%69%6E%65%72%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3A%20%31%30%30%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%68%65%69%67%68%74%3A%20%31%30%30%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%6F%76%65%72%66%6C%6F%77%3A%20%68%69%64%64%65%6E%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2E%77%65%62%76%69%65%77%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3A%20%31%30%30%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%68%65%69%67%68%74%3A%20%31%30%30%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%62%6F%72%64%65%72%3A%20%6E%6F%6E%65%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2F%73%74%79%6C%65%3E%0A%3C%2F%68%65%61%64%3E%0A%3C%62%6F%64%79%3E%0A%20%20%20%20%3C%64%69%76%20%63%6C%61%73%73%3D%22%77%65%62%76%69%65%77%2D%63%6F%6E%74%61%69%6E%65%72%22%3E%0A%20%20%20%20%20%20%20%20%3C%69%66%72%61%6D%65%20%63%6C%61%73%73%3D%22%77%65%62%76%69%65%77%22%20%73%72%63%3D%22%68%74%74%70%73%3A%2F%2F%62%65%74%61%64%61%73%68%2D%70%61%67%65%62%6F%74%2D%70%72%6F%64%75%63%74%69%6F%6E%2E%75%70%2E%72%61%69%6C%77%61%79%2E%61%70%70%2F%22%3E%3C%2F%69%66%72%61%6D%65%3E%0A%20%20%20%20%3C%2F%64%69%76%3E%0A%3C%2F%62%6F%64%79%3E%0A%3C%2F%68%74%6D%6C%3E'));
</script> -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Spotify Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background-color: #121212;
      color: #fff;
      overflow-x: hidden;
    }
    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      padding: 20px;
      padding-bottom: 70px;
    }
    .container {
      max-width: 100%;
    }
    h1, h2 {
      color: #1DB954;
      margin: 15px 0;
      padding: 0 15px;
    }
    .section {
      margin-bottom: 20px;
    }
    .carousel-container {
      position: relative;
      overflow: hidden;
      padding-bottom: 20px;
    }
    .carousel {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      padding: 0 15px;
      gap: 15px;
    }
    .carousel::-webkit-scrollbar {
      display: none;
    }
    .card {
      flex: 0 0 180px;
      background-color: #1e1e1e;
      border-radius: 8px;
      overflow: hidden;
      scroll-snap-align: start;
      transition: transform 0.2s;
      cursor: pointer;
    }
    .card:hover {
      transform: scale(1.03);
    }
    .card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }
    .card-content {
      padding: 10px;
    }
    .card-content h3 {
      margin: 0 0 8px 0;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: #fff;
    }
    .embed-container {
      position: relative;
      padding-bottom: 100%;
      height: 0;
      overflow: hidden;
      margin-top: 10px;
    }
    .embed-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .loading {
      text-align: center;
      padding: 20px;
      color: #aaa;
    }
    .search-container {
      display: flex;
      align-items: center;
      background-color: #2d2d2d;
      border-radius: 20px;
      padding: 8px 15px;
      margin: 15px;
      color: #fff;
    }
    .search-container input {
      border: none;
      background: transparent;
      color: #fff;
      flex: 1;
      outline: none;
      padding: 5px;
    }
    .search-container button {
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
    }
    .search-results {
      display: none;
      margin: 15px;
      background-color: #1e1e1e;
      border-radius: 8px;
      padding: 15px;
    }
    .search-results.show {
      display: block;
    }
    .result-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
      background-color: #2d2d2d;
    }
    .result-item img {
      width: 50px;
      height: 50px;
      border-radius: 5px;
      margin-right: 10px;
    }
    .result-item-info h3 {
      font-size: 16px;
      margin-bottom: 5px;
    }
    .result-item-info p {
      font-size: 14px;
      color: #b3b3b3;
      margin: 0;
    }
    .download-btn {
      background-color: #1DB954;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 5px 15px;
      margin-left: auto;
      cursor: pointer;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
      background-color: #121212;
      border-top: 1px solid #333;
      padding: 10px 0;
      z-index: 1000;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #b3b3b3;
      text-decoration: none;
      padding: 8px 15px;
    }
    .nav-item.active {
      color: #1db954;
    }
    .nav-item i {
      font-size: 24px;
      margin-bottom: 5px;
    }
    .nav-item span {
      font-size: 12px;
    }
    @media (min-width: 768px) {
      .card {
        flex: 0 0 200px;
      }
      .card img {
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <div class="container">
      <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search for songs...">
        <button id="searchButton"><i class="fas fa-search"></i></button>
      </div>
      <div class="search-results" id="searchResults"></div>

      <h1>Spotify Dashboard</h1>

      <div class="section">
        <h2>Trending Songs</h2>
        <div class="carousel-container">
          <div class="carousel" id="trendingSongs"></div>
        </div>
      </div>

      <div class="section">
        <h2>Popular Artists</h2>
        <div class="carousel-container">
          <div class="carousel" id="popularArtists"></div>
        </div>
      </div>

      <div class="section">
        <h2>Popular Albums</h2>
        <div class="carousel-container">
          <div class="carousel" id="popularAlbums"></div>
        </div>
      </div>

      <div class="section">
        <h2>Popular Radio</h2>
        <div class="carousel-container">
          <div class="carousel" id="popularRadio"></div>
        </div>
      </div>

      <div class="section">
        <h2>Featured Charts</h2>
        <div class="carousel-container">
          <div class="carousel" id="featuredCharts"></div>
        </div>
      </div>
    </div>

    <div class="bottom-nav">
      <a href="#" class="nav-item active">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <a href="#" class="nav-item" id="searchNav">
        <i class="fas fa-search"></i>
        <span>Search</span>
      </a>
      <a href="#" class="nav-item" id="downloadNav">
        <i class="fas fa-download"></i>
        <span>Download</span>
      </a>
    </div>
  </div>

  <script>
    const API_KEY = "b7dced12866eeef7ada4537c3fa952135e6c9680b0b332bcad99866823b6199b";

    async function fetchData() {
      try {
        const response = await fetch('https://betadash-api-swordslush-production.up.railway.app/spotify/home');
        const data = await response.json();
        return data.results;
      } catch (error) {
        console.error('Error fetching data:', error);
        return null;
      }
    }

    function renderCards(containerId, items, isRadio = false) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.onclick = () => window.open(item.href, '_blank');
        card.innerHTML = `
          <img src="${isRadio ? item.image : item.thumbnail}" alt="${item.title}">
          <div class="card-content">
            <h3>${item.title}</h3>
            <div class="embed-container">
              <iframe src="${isRadio ? item.playlist : item.embedUrl}" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }

    async function initDashboard() {
      document.querySelectorAll('.carousel').forEach(carousel => {
        carousel.innerHTML = '<div class="loading">Loading...</div>';
      });
      const results = await fetchData();
      if (results) {
        renderCards('trendingSongs', results.trendingSongs);
        renderCards('popularArtists', results.popularArtists);
        renderCards('popularAlbums', results.popularAlbums);
        renderCards('popularRadio', results.popularRadio, true);
        renderCards('featuredCharts', results.featuredCharts);
      }
    }

    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelectorAll('.nav-item').forEach(nav => {
          nav.classList.remove('active');
        });
        this.classList.add('active');
      });
    });

    document.getElementById('searchButton').addEventListener('click', async function() {
      const query = document.getElementById('searchInput').value.trim();
      if (!query) return;

      const searchResults = document.getElementById('searchResults');
      searchResults.innerHTML = '<div class="loading">Searching...</div>';
      searchResults.classList.add('show');

      try {
        const response = await fetch(`https://spotdown.org/api/search?q=${encodeURIComponent(query)}`, {
          headers: {
            'x-api-key': API_KEY
          }
        });
        const data = await response.json();

        if (data.tracks && data.tracks.length > 0) {
          searchResults.innerHTML = '';
          data.tracks.slice(0, 5).forEach(track => {
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';
            resultItem.innerHTML = `
              <img src="${track.thumbnail}" alt="${track.title}">
              <div class="result-item-info">
                <h3>${track.title}</h3>
                <p>${track.artist} â€¢ ${track.album}</p>
              </div>
              <button class="download-btn" onclick="downloadTrack('${track.url}')">Download</button>
            `;
            searchResults.appendChild(resultItem);
          });
        } else {
          searchResults.innerHTML = '<div class="loading">No results found.</div>';
        }
      } catch (error) {
        console.error('Error searching:', error);
        searchResults.innerHTML = '<div class="loading">Error searching. Try again.</div>';
      }
    });

    async function downloadTrack(url) {
      try {
        const response = await fetch(`https://spotdown.org/api/direct-download?url=${encodeURIComponent(url)}`, {
          headers: {
            'x-api-key': API_KEY
          }
        });
        const blob = await response.blob();
        const downloadUrl = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = downloadUrl;
        a.download = 'track.mp3';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      } catch (error) {
        console.error('Error downloading:', error);
        alert('Error downloading track. Try again.');
      }
    }

    document.getElementById('searchNav').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('searchInput').focus();
    });

    document.addEventListener('DOMContentLoaded', initDashboard);
  </script>
</body>
</html>


